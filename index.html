<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨ÙŠÙ† - ÙƒÙ„ÙŠØ© Ø§Ù„Ø´Ù…Ø§Ù„ Ù„Ù„ØªÙ…Ø±ÙŠØ¶ Ø§Ù„Ø£Ù‡Ù„ÙŠØ©</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #0f172a;
            color: #e2e8f0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            padding: 2rem;
            border-bottom: 3px solid #2563eb;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo {
            width: 80px;
            height: 80px;
        }

        .title-section {
            flex: 1;
            text-align: center;
            min-width: 250px;
        }

        .title-section h1 {
            font-size: 1.8rem;
            color: #2563eb;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .title-section p {
            color: #94a3b8;
            font-size: 1rem;
        }

        .date-display {
            background: #1e293b;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            border: 1px solid #334155;
            font-size: 0.95rem;
            white-space: nowrap;
        }

        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
            flex: 1;
        }

        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .tab-button {
            background: #1e293b;
            color: #e2e8f0;
            border: 2px solid #334155;
            padding: 0.75rem 2rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-family: 'Tajawal', sans-serif;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .tab-button:hover {
            background: #334155;
            border-color: #2563eb;
        }

        .tab-button.active {
            background: #2563eb;
            border-color: #2563eb;
            color: white;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: #1e293b;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            margin-bottom: 1.5rem;
            border: 1px solid #334155;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #94a3b8;
            font-weight: 500;
        }

        .form-group select,
        .form-group input {
            width: 100%;
            padding: 0.75rem;
            background: #0f172a;
            border: 2px solid #334155;
            border-radius: 8px;
            color: #e2e8f0;
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #2563eb;
        }

        .btn {
            background: #2563eb;
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover {
            background: #1d4ed8;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .search-filters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: #0f172a;
            border-radius: 8px;
            overflow: hidden;
        }

        thead {
            background: #2563eb;
        }

        th {
            padding: 1rem;
            text-align: right;
            font-weight: 600;
            color: white;
        }

        td {
            padding: 1rem;
            border-bottom: 1px solid #334155;
        }

        tbody tr:hover {
            background: #1e293b;
        }

        tbody tr:last-child td {
            border-bottom: none;
        }

        .footer {
            background: #1e293b;
            padding: 1.5rem;
            text-align: center;
            color: #94a3b8;
            border-top: 3px solid #2563eb;
            margin-top: auto;
        }

        .no-data {
            text-align: center;
            padding: 3rem;
            color: #64748b;
            font-size: 1.1rem;
        }

        /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            border-radius: 12px;
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            border: 1px solid #334155;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(37, 99, 235, 0.3);
            border-color: #2563eb;
        }

        .stat-icon {
            font-size: 2.5rem;
            background: #2563eb;
            width: 70px;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
        }

        .stat-content {
            flex: 1;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #2563eb;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #94a3b8;
        }

        .progress-bar {
            background: #0f172a;
            height: 30px;
            border-radius: 8px;
            overflow: hidden;
            margin: 0.5rem 0;
            position: relative;
        }

        .progress-fill {
            background: linear-gradient(90deg, #2563eb 0%, #3b82f6 100%);
            height: 100%;
            display: flex;
            align-items: center;
            padding: 0 0.75rem;
            color: white;
            font-weight: 500;
            font-size: 0.85rem;
            transition: width 0.6s ease;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem;
            border-bottom: 1px solid #334155;
        }

        .stat-item:last-child {
            border-bottom: none;
        }

        .stat-item:hover {
            background: #0f172a;
        }

        @media print {
            body {
                background: white;
                color: black;
            }

            .header {
                background: white;
                border-bottom: 2px solid #2563eb;
            }

            .tabs,
            .btn,
            .search-filters,
            .footer,
            .stats-container {
                display: none !important;
            }

            .card {
                background: white;
                box-shadow: none;
                border: 1px solid #ddd;
            }

            table {
                background: white;
            }

            th {
                background: #2563eb !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            td {
                color: black;
            }

            .title-section h1 {
                color: #2563eb;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }

            .logo {
                width: 60px;
                height: 60px;
            }

            .title-section h1 {
                font-size: 1.3rem;
            }

            .card {
                padding: 1rem;
            }

            table {
                font-size: 0.9rem;
            }

            th, td {
                padding: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <img class="logo" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIHI9IjQ4IiBzdHJva2U9IiMyNTYzZWIiIHN0cm9rZS13aWR0aD0iMyIvPgo8cGF0aCBkPSJNNTAgMjBDNTAgMjAgMzUgMzUgMzUgNTBDMzUgNjUgNTAgODAgNTAgODBDNTAgODAgNjUgNjUgNjUgNTBDNjUgMzUgNTAgMjAgNTAgMjBaIiBmaWxsPSIjMjU2M2ViIi8+CjxyZWN0IHg9IjQwIiB5PSI0MCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjgiIGZpbGw9IndoaXRlIi8+CjxyZWN0IHg9IjQwIiB5PSI1MiIgd2lkdGg9IjIwIiBoZWlnaHQ9IjgiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=" alt="Ø´Ø¹Ø§Ø± ÙƒÙ„ÙŠØ© Ø§Ù„Ø´Ù…Ø§Ù„">
            <div class="title-section">
                <h1>Ù†Ø¸Ø§Ù… Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨ÙŠÙ†</h1>
                <p>ÙƒÙ„ÙŠØ© Ø§Ù„Ø´Ù…Ø§Ù„ Ù„Ù„ØªÙ…Ø±ÙŠØ¶ Ø§Ù„Ø£Ù‡Ù„ÙŠØ©</p>
            </div>
            <div class="date-display" id="currentDate"></div>
        </div>
    </div>

    <div class="container">
        <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-icon">ğŸ‘¥</div>
                <div class="stat-content">
                    <div class="stat-value" id="totalMonitors">0</div>
                    <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨ÙŠÙ†</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ğŸ“…</div>
                <div class="stat-content">
                    <div class="stat-value" id="totalPeriods">0</div>
                    <div class="stat-label">Ø¹Ø¯Ø¯ Ø§Ù„ÙØªØ±Ø§Øª</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ğŸ«</div>
                <div class="stat-content">
                    <div class="stat-value" id="totalRooms">0</div>
                    <div class="stat-label">Ø¹Ø¯Ø¯ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ğŸ“Š</div>
                <div class="stat-content">
                    <div class="stat-value" id="totalAssignments">0</div>
                    <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù‡Ø§Ù…</div>
                </div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab-button active" onclick="switchTab('monitor')">ğŸŸ© Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨</button>
            <button class="tab-button" onclick="switchTab('committee')">ğŸŸ¦ Ù„Ø¬Ù†Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</button>
            <button class="tab-button" onclick="switchTab('statistics')">ğŸ“ˆ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</button>
        </div>

        <div id="monitorTab" class="tab-content active">
            <div class="card">
                <div class="form-group">
                    <label>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨:</label>
                    <select id="monitorSelect" onchange="loadMonitorSchedule()">
                        <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨ --</option>
                    </select>
                </div>
                <button class="btn" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
            </div>
            <div id="monitorResult"></div>
        </div>

        <div id="committeeTab" class="tab-content">
            <div class="card">
                <div class="search-filters">
                    <div class="form-group">
                        <label>Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ù„ÙØªØ±Ø©:</label>
                        <select id="periodSelect" onchange="searchCommittee()">
                            <option value="">-- Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØªØ±Ø§Øª --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ù„Ù‚Ø§Ø¹Ø©:</label>
                        <input type="text" id="roomInput" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‚Ø§Ø¹Ø©" oninput="searchCommittee()">
                    </div>
                    <div class="form-group">
                        <label>Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨:</label>
                        <select id="committeeMonitorSelect" onchange="searchCommittee()">
                            <option value="">-- Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨ÙŠÙ† --</option>
                        </select>
                    </div>
                </div>
            </div>
            <div id="committeeResult"></div>
        </div>

        <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
        <div id="statisticsTab" class="tab-content">
            <div class="card">
                <h2 style="color: #2563eb; margin-bottom: 1.5rem;">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø´Ø§Ù…Ù„Ø©</h2>
                <div id="detailedStats"></div>
            </div>
            
            <div class="card">
                <h2 style="color: #2563eb; margin-bottom: 1.5rem;">ğŸ† Ø£ÙƒØ«Ø± Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨ÙŠÙ† Ù†Ø´Ø§Ø·Ù‹Ø§</h2>
                <div id="topMonitors"></div>
            </div>

            <div class="card">
                <h2 style="color: #2563eb; margin-bottom: 1.5rem;">ğŸ« Ø§Ù„Ù‚Ø§Ø¹Ø§Øª Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‹Ø§</h2>
                <div id="topRooms"></div>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>Â© ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ·ÙˆÙŠØ± ÙˆØ§Ù„Ø¬ÙˆØ¯Ø© â€“ ÙƒÙ„ÙŠØ© Ø§Ù„Ø´Ù…Ø§Ù„ Ù„Ù„ØªÙ…Ø±ÙŠØ¶ Ø§Ù„Ø£Ù‡Ù„ÙŠØ©</p>
    </div>

    <script>
        let data = [];
        
        // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ø§Ù„Ù…Ø¯Ù…Ø¬Ø© Ù…Ø¨Ø§Ø´Ø±Ø©
        const RAW_DATA_TEXT = `Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨	2025-10-26 (Ø§Ù„Ø£ÙˆÙ„Ù‰)	2025-10-26 (Ø§Ù„Ø«Ø§Ù†ÙŠØ©)	2025-10-27 (Ø§Ù„Ø£ÙˆÙ„Ù‰)	2025-10-27 (Ø§Ù„Ø«Ø§Ù†ÙŠØ©)	2025-10-28 (Ø§Ù„Ø£ÙˆÙ„Ù‰)	2025-10-28 (Ø§Ù„Ø«Ø§Ù†ÙŠØ©)	2025-10-29 (Ø§Ù„Ø£ÙˆÙ„Ù‰)	2025-10-29 (Ø§Ù„Ø«Ø§Ù†ÙŠØ©)	2025-10-30 (Ø§Ù„Ø£ÙˆÙ„Ù‰)	2025-10-30 (Ø§Ù„Ø«Ø§Ù†ÙŠØ©)	2025-11-02 (Ø§Ù„Ø£ÙˆÙ„Ù‰)	2025-11-02 (Ø§Ù„Ø«Ø§Ù†ÙŠØ©)	2025-11-03 (Ø§Ù„Ø£ÙˆÙ„Ù‰)	2025-11-03 (Ø§Ù„Ø«Ø§Ù†ÙŠØ©)	2025-11-04 (Ø§Ù„Ø£ÙˆÙ„Ù‰)	2025-11-04 (Ø§Ù„Ø«Ø§Ù†ÙŠØ©)	2025-11-05 (Ø§Ù„Ø£ÙˆÙ„Ù‰)	2025-11-05 (Ø§Ù„Ø«Ø§Ù†ÙŠØ©)	2025-11-06 (Ø§Ù„Ø£ÙˆÙ„Ù‰)	26(4:00-5:00)	26(5:30-6:30)	27(4:00-5:00)	27(5:30-6:30)	28(4:00-5:00)	28(5:30-6:30)	29(4:00-5:00)	29(5:30-6:30)	30(4:00-5:00)	30(5:30-6:30)	2(4:00-5:00)	2(5:30-6:30)	3(4:00-5:00)	3(5:30-6:30)	4(4:00-5:00)	4(5:30-6:30)	5(4:00-5:00)	5(5:30-6:30)	6(4:00-5:00)
Ø£Ø³Ù…Ø§Ø¡ Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ø¹Ø§Ù…Ø±	A7		A7	A7	A7		A7	A7	H6			B6	A7		A7		A7		A7						D8							C6				C7		
Ø£Ù…Ø§Ù„ Ù‡Ø§Ø´Ù… Ù…Ø­Ù…Ø¯	A7		A7	A7	A7		A7	A7	H8			B6				A7	A7	A7		D7				C6						C7				C7				
Ø£Ù…Ø§Ù†ÙŠ Ù„Ø·ÙÙŠ Ø£Ø­Ù…Ø¯ Ø¹Ù…Ø§Ø±Ø©	A8		A8	A7	A7		A8	A7	A7			B6	A7		A7		A8	A7		C7						F10		D8										
Ø£Ù…ÙŠØ±Ø© Ù…ØµØ·ÙÙ‰ ÙÙ‡Ù…ÙŠ Ø§Ø³Ù…Ø§Ø¹ÙŠÙ„	A8		A8	A8	A8		A8	A8	A7	A7		B7	A7		A7		A8	A7														C8		C6				
Ø£Ù†ÙØ§Ù„ Ø³Ø§ÙŠØ± Ù…Ø±Ø­ÙˆÙ„ Ø§Ù„Ø±ÙˆÙŠÙ„ÙŠ	B1		B1	A8	A8		B6	A8	A7			B7	A8		A8		B3	A8	A7															D5	D6			
Ø¥Ø¯Ù„ÙŠÙ†Ø§ Ø³Ø§Ù†ØªÙˆØ³	B1		B1	A8	A8		B6	A8	A8			B7	A8		A8		B3	A8	A7															C8				C6
Ø¥ÙŠÙ…Ø§Ù† Ù…Ø®ØªØ§Ø± Ù…Ø­Ù…Ø¯ Ø¬Ø¨Ø±	B2		B2	B6	B6		B7	B6	A8			B8					B6								D7		F7							D4	D6			D6
Ø§Ø³Ù…Ø§Ø¡ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ø­Ù…Ø¯ Ø­Ø³ÙŠÙ†	B2		B2	B6	B6		B7	B6	A8			B8	A8		A8		B6	A8		D7										B8								D7
Ø§Ø´Ø±Ø§Ù‚Ù‡ Ø¹Ø¨ÙŠØ¯ Ù…Ø­Ù…Ø¯ ØµØ§Ù„Ø­	B3		B3	B6	B6		B8	B6	B6			B8	B6		B6		B7	B6				D5				F9												
Ø§ÙŠÙ…Ø§Ù† Ù…Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ø¨ÙˆØ¨ÙƒØ±	B3		B3	B7	B7		B8	B7	B6			C6	B6				B7	B6				D6					F7			C7						D8		
Ø¨ØªØ¹Ø© Ù…Ø­Ù…ÙˆØ¯ Ù…Ø­Ù…Ø¯ Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„	B6		B6	B7	B7		C2	B7	B7			C6	B6		B6		B8	B6	A8						D8					C6								
Ø¨Ø±Ø§Ø¡ Ø·Ø¹Ù…Ø© Ø§Ø¨ÙˆØ§Ù„Ø³Ù„	B6		B6	B7	B7		C2	B7	B7			C6	B7		B6	A7	B8										F7		D7		B7							
Ø¬ÙŠÙ‡Ø§Ù† Ø§Ø­Ù…Ø¯ Ø§Ù„Ø¨Ù‡Ù„ÙˆØ§Ù†	B7		B7	B8	B8		C6	B8	B7			C7	B7		B7		C2	B7						C7						C6					C9			
Ø¯Ø§Ù„ÙŠØ§ Ù…Ø­Ù…Ø¯ ÙØªØ­ÙŠ Ø¹Ø¨Ø¯ Ø§Ù„Ù…Ù‚ØµÙˆØ¯	B7		B7	B8	B8		C6	B8	B8			C7	B7		B7	A7	C2	B7																D5		D8		
Ø±Ø§Ù†ÙŠØ§ Ø¹Ø¨Ø¯ Ø§Ù„Ø®Ø§Ù„Ù‚ Ø¬ÙˆØ¯Ø© Ø§Ù„Ø­Ø³ÙŠÙ†	B8		B8	B8	B8		C7	B8	B8	A7		C7	B8		B7	A8	C6	B7	A8																			
Ø±Ø´Ø§ Ø¹Ø¨Ø¯Ø§Ù„Ø­Ù„ÙŠÙ…  Ø§Ù„Ù‚Ø§Ø¶ÙŠ	B8	A7	B8	C2	C6		C7	D6	C6			C8	B8		C7	A8	C6	B8	A8																			
Ø±ÙˆÙ„Ø§ Ø­Ø³Ù† Ù…Ø­Ù…Ø¯ Ø§Ø²Ù‡Ø±ÙŠ	C6		C2	C2	C7		C8	D6	C7	A7		C8	C6		C7		C7	B8		D7																		
Ø±ÙŠÙ… Ø¹Ù„ÙŠ Ø­ÙˆÙØ§Ù† Ø§Ù„Ø´Ù…Ø±Ø§Ù†ÙŠ	C7	A7	C6	C6	C7	A7	C9	D7	C7	A8																												
Ø²ÙŠÙ†Ø¨ Ø±Ø¨ÙŠØ¹ Ø¹Ø¨Ø¯ Ø§Ù„Ù…Ø±Ø¶ÙŠ	C7		C6	C6	C7		C9	D7	C7			C9	C6		C8		C8	C6							D7							F9						C9
Ø³Ø§Ø±Ø© Ø±ÙˆÙŠØ´Ø¯ Ø®ÙˆÙŠØªÙŠÙ… Ø§Ù„Ø¹Ù†Ø²ÙŠ	C8		C7	C6	C8	A7	D4	D7	C8	A8		C9	C7		C8		C8															C9	A7					
Ø³Ù„ÙˆÙŠ Ù…Ø­Ù…Ø¯ Ø¬Ù…ÙŠÙ„  Ø§Ù„ÙˆÙØ§Ø¦ÙŠ	C8	A7	C7	F10	C8		D4	D8	C8	A8		C9	C7			C6	C9		C6																			C8
Ø³Ù‡Ø§Ù… Ø´Ø­Ø§ØªÙ‡ Ù…ØµØ·ÙÙ‰ Ù…Ø±Ø²ÙˆÙ‚	D1	A8	C8	F10	C8		D6	D8	C9			D6	C7			C6	C9		C6			D5					A7											
Ø³ÙŠØ±Ù„ÙŠ Ø£Ø¬Ù†ÙˆØ¯	D1		C8	F10	C9		D6	D8	C9	B6		D6	C8	C7		C6	D4		C7	D8																		
Ø´Ù‡Ø¯ Ø²ÙŠØ§Ø¯ Ø¹Ù„ÙŠ Ø§Ù„Ø¯Ù†Ø¯Ù†	D4		C9	F8	C9		D7		D6	B6		D6	C8	C7		C7	D4		C7			D7										C6						
Ø¶Ø­Ù‰ Ø¹Ø¨Ø¯ Ø§Ù„Ù‡Ø§Ø¯ÙŠ  Ù…Ø­Ù…Ø¯	D4		C9	F8	C9	A7	D7		D6	B6		D8	C8	C7			D5					D5						D8	D7									
Ø¹Ø§ÙŠØ¯Ø© Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…	D5		D5	F8	D5	A8	D8		D7	B7	A7		C9				D5					D6							D7			C7						D6
ØºØ§Ø¯Ø© ØµØ¨Ø­ÙŠ Ø­Ø³Ù†	D5		D5	F9	D5	A8	D8		D7	B7	A7		C9			C7	D6	C6													B7							D7
ÙØ§ØªÙ† ÙØªØ­Ù‰ Ø£Ø­Ù…Ø¯ Ù…Ø­ÙÙˆØ¸	D6		D6	F9	D6	A8	E10		E6	B7	A7		C9				D6	C6								F9						C7						C8
Ù„Ù…ÙŠØ§Ø¡ Ø¹Ø¨Ø¯ Ø§Ù„Ø­ÙƒÙŠÙ… Ø¹Ù„Ù‰ ØºØ±Ø§Ø¨	D6		D6		D6	B6	E10		E6	B8	A8		E10			C7	D7	C7	C7	D8												F9						
Ù…Ø¢Ø«Ø± Ø¬Ø¯Ø¹Ø§Ù† Ø¹Ø¨Ø¯Ø§Ù„Ø­Ù…Ù† Ø§Ù„Ø¬Ø¯ÙŠØ¹	D7		D7		D6	B6	E6		E8	B8	A8		E10			C8	D7		C8							F9							F10					C9
Ù…Ø«Ø§ÙŠÙ„ ÙÙ‡Ø¯ Ù…Ø¨Ø§Ø±Ùƒ Ø§Ù„Ø´Ù…Ø±ÙŠ	D7		D7		D7	B6	E6		E8	B8	A8	D8	E10	C8		C8	D8	C7											D6									
Ù…Ù„Ø§Ùƒ Ù…Ø­Ù…Ø¯ ÙŠØ­ÙŠÙ‰ ÙŠØ¹Ù‚ÙˆØ¨	D8		D8		D7	B7	E8		E9	C6	B6		E9	C8		C8	D8	C7	C8								A8											
Ù…Ù†Ø§Ù„ Ø³Ù„Ø·Ø§Ù† Ù…Ø¯Ø§Ø¯ Ø§Ù„Ø±ÙˆÙŠÙ„ÙŠ	D8		D8		D7	B7	E8		E9	C6	B6		E9	C9		C9	E6	C9	C8																			D7
Ù…Ù†Ø§Ù„ Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ²	E10	A8	E10		D8	B7	E9		F10	C6	B6		E9			C9	E6										A8						F10		D6			
Ù…Ù†Ù‰ ØªÙŠÙ…Ø§Ù† Ø¥Ø¯Ø±ÙŠØ³ Ù‚ØµØ¨	E10	A8	E10		D8	B8	E9		F10	C7	B7		F10	C10		C9	E8																D4		D7			
Ù…Ù‡Ø§ Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… ÙØ¤Ø§Ø¯ Ø§Ù„Ø¹Ø´Ø±ÙŠ ÙÙˆØ¯Ø©	E6		E6		D8	B8	F2		F10	C7	B7		F10	C11		D6	E8		C9															C7				C6
Ù†Ø¬ÙˆØ¯ Ø¹ÙˆØ§Ø¯ Ø¹ÙˆØ¯Ø© Ø§Ù„Ø¹Ø·ÙˆÙ‰	E6		E6		F10	B8	F2		F6	C7	B7		F10	C12		D6	E9											C8						C6	D7			
Ù†Ø¯Ù‰ ØµÙ‚Ø± Ø­ÙˆÙŠÙ„ Ø§Ù„Ø±ÙˆÙŠÙ„ÙŠ	E8		E8		F10	D6	F5		F6	D6	D6		F6	C13		D6	E9		C9								A8	D8										
Ù†Ø±Ø¬Ø³ Ù…Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ ØµÙŠØ§Ù…	E8		E8		F10	D6	F5		F7	D6	D6		F6	C14			F6		C9								A8	C9		B8								
Ù†Ø¹ÙŠÙ…Ø© Ù…Ø­Ù…Ø¯ Ø§Ù„Ø³ÙŠØ¯ Ø§Ø­Ù…Ø¯	E9		E9		F8	D6	F6		F7	D6	D6		F6	C15			F6					D7										C8	D5		C9			
Ù‡Ø¨Ø© Ø£Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø¹Ø·ÙŠ	E9		E9		F8	D7	F6		F8	D7	D7		F7	C16			F7		D6			D7							D6	B8								
Ù‡Ø¯Ø§ÙŠØ§ Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ Ø£Ø¨Ùˆ Ø¨ÙƒØ± Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„	F8		F1		F8		F7		F8	D7	D7		F7	C17	C8	D7	F7		D6			D8										C9						
Ù‡Ø¯ÙŠ Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­Ù…Ù† ÙÙ„ÙŠÙÙ„	F8		F1		F9		F7		F9	D7	D7		F7	C18			F8		D6			D8				F10			C6						C8			
Ù‡Ù†Ø¯ Ø§Ø¨Ùˆ Ø§Ù„Ø³Ø¹ÙˆØ¯ Ø£Ø­Ù…Ø¯ Ø§Ù„ØµØ¹ÙŠØ¯ÙŠ	F9		F10		F9	D7	F8		F9	D8	D8		F8	C19	C9	D7	F8		D7							C8												
Ù‡ÙˆÙŠØ¯Ø§ Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ Ø­Ø³Ù†										D8	D8	D8	F8	C8	C9	D7	F9	C9	D7	C9					D7	C9	A7		D6		B7							
ÙŠØ§Ø³Ù…ÙŠÙ† Ø³Ø§Ù„Ù… Ø¯Ø±Ø§Ù‚	F9		F10	F9	F9	D7	F8		F9	D8	D8		F8		C9		F9	C9	D7															D4				
Ù†Ø¨ÙŠÙ„Ø© Ø³Ø§Ù„Ù… Ù…Ø­Ù…Ø¯ Ø³Ø§Ù„Ù…			F2																																			
Ù†Ù‡ÙŠØ¯ Ø§Ù„Ø®Ø·ÙŠØ¨			F2																																			
Ø¥Ø¯Ø§Ø±ÙŠØ© 1			F5																																			
Ø¥Ø¯Ø§Ø±ÙŠØ© 2			F5																																			
Ø¥Ø¯Ø§Ø±ÙŠØ©3			F6																																			
Ø¥Ø¯Ø§Ø±ÙŠØ© 4			F6																																			
Ø¥Ø¯Ø§Ø±ÙŠØ© 5			F9																																			
Ø¥Ø¯Ø§Ø±ÙŠØ© 6			F9																																			
Ø¥Ø¯Ø§Ø±ÙŠØ© 7	C6		C2				C8		C6								C7																					
Ø£Ø­Ù…Ø¯ Ø¬Ù…Ø§Ù„ Ø§Ù„Ø¯ÙŠÙ† Ù…Ø­Ù…Ø¯	G1		G1		G1	G1	G1		G3	G1		G1	G5	G1	G1		G1		G1							C6										C7		
Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ ÙˆÙ‡Ø¨Ø© Ø§Ù„Ø³ÙŠØ¯	G1		G1		G1	G1	G1	G1	G3			G1	G5				G1	G1	G1	C7							A7		C7									
Ø£Ø´Ø±Ù Ø£Ù…ÙŠÙ†  Ø§Ù„Ø·Ø­Ø§Ù†	G2		G2		G2	G1	G2	G1	G4	G1	G1		G5	G1			G3	G1	G2							C8												
Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø§Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ø³Ù…Ø§Ø­ÙŠ	G2		G2		G2	G3	G2		G4	G1			G6				G3	G2	G2	C8						C7			C6						C8			
Ø¨Ø´Ø§Ø±Ø© Ø¥Ù„ÙŠØ§Ø³ Ø­Ù…Ø¯ØªÙˆ	G3		G3		G6	G3	G5		G5	G2					G1	G1	G4	G2	G3			C7				C6							A7					
Ø¯Ø§Ù†ÙŠØ§Ù„ Ø¬ÙˆØ²ÙŠÙ Ø¥Ø³Ø¨ÙŠÙ†Ø§	G3		G3	G1	G6	G3	G5	G1	G5	G2	G1		G6		G1		G4	G4	G3																			
Ø³Ù„Ø·Ø§Ù† Ø¹ÙŠØ§Ø¯Ø© Ø«Ø§Ù†ÙŠ Ø§Ù„Ø´Ù…Ø±ÙŠ	G6		G4		G7	G4	G6	G2	G6	G2			G6			G1	G5		G4						C9								A7					C6
Ø³Ù…ÙŠØ± Ù‡Ø§Ø´Ù… Ù‡Ø§Ø´Ù… Ø®Ù„ÙŠÙØ©	G6		G4	G1	G7	G4	G6	G2	G6	G3	G1	G1	G7		G2	G1	G5		G4																			
Ø¹Ø¨Ø¯ Ø§Ù„Ù‚Ø§Ø¯Ø± Ø§Ù„Ø£Ù…ÙŠÙ† Ø§Ù„Ø£Ù…ÙŠÙ†	G7		G5	G1	G8		G7	G2	G7				G7				G6		G5	C9					C8		A7	C8	C7									
Ø¹Ø¯Ù†Ø§Ù† ÙØ§Ø±Ø³ Ù…Ø²Ù‡ÙŠ Ø§Ù„Ø¹Ù†Ø²ÙŠ	G7		G5	G2	G8		G7	G3	G7				G7	G1			G6			C7		C8			C9	C9			C6									
Ø¹Ù„ÙŠ  Ø­Ø³ÙŠÙ† Ø¹Ø¨Ø¯ Ø§Ù„Ù…Ø¬ÙŠØ¯ Ù…Ø­Ù…Ø¯	H3		G6	G2	H1		H2	G3	G8			G3	G8		G2	G4	G7									C7		C9		C6								
Ø¹Ù…Ø§Ø¯ Ù…Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„ØªÙˆØ§Ø¨	H3		G6	G2	H1		H2	G3	G8	G3	G2		G8		G2		G7								C8	C8						C9						
Ø¹Ù…Ø± Ù…Ø­Ù…Ø¯ ÙØ¶Ù„ Ø§Ù„Ù…ÙˆÙ„Ù‰ Ø³Ø¹ÙŠØ¯	H4		G7	G3	H2		H3	G4	H1	G3	G2		G8		G3		G8					C8		C7												C7		
Ø¹Ù…Ø±Ùˆ Ù…Ø­Ù…ÙˆØ¯ Ø¹Ø¨Ø¯ Ø§Ù„Ø¯Ø§ÙŠÙ… Ù…Ø­Ù…Ø¯	H4		G7	G3	H2		H3	G4	H1		G2		H1			G4	G8											C9				C8			C9			C8
ÙƒØ±ÙŠÙ… Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù‡Ø§Ø¯ÙŠ	H5		G8	G3	H4		H4	G4	H3	G4	G3		H1			G4	H1									C6			C6						C8			
Ù…Ø­Ù…Ø¯ Ø§Ù„Ø³ÙŠØ¯ Ù…ØµØ·ÙÙ‰ Ø¹Ø¨Ø¯ Ø§Ù„Ø¹Ø§Ù„	H5	G1	G8	G5	H4	G4	H4	G7	H3	G4			H2				H1			C8						C7			C7									
Ù…Ø­Ù…Ø¯ Ù…Ø­Ù…ÙˆØ¯ Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ù‡Ù„Ø§Ù„	H6	G1	H1	G5			H5	G7	H4	G4			H2				H3											C8				C8				C7		C9
Ù…Ø­Ù…Ø¯ Ù…ØµØ·ÙÙ‰ Ù…Ø­Ù…ÙˆØ¯ Ø³Ù„Ø·Ø§Ù†	H6	G1	H1	G5	H4		H5	G7	H4	G7	G3		H3				H3											C9					A7					C6
Ù…ÙˆØ³ÙŠ Ø¹Ø¨Ø¯Ø§Ù„ÙØªØ§Ø­ Ù…ÙˆØ³ÙŠ Ø­Ø³Ù†	H7	G2	H2	G6	H5		H6	G8	H5	G7			H3				H6					C7		C6	C9	C6												
Ù†Ø¯Ø§Ø¡ Ù‡Ø²Ø§Ø¹ Ù†Ø¯Ø§Ø¡ Ø§Ù„Ø´Ù…Ø±Ù‰	H7	G2	H2	G6	H5		H6	G8	H5	G7		G3	H4		G3		H6								C8	C8												
ÙˆÙ„Ø§Ø¡ Ø¹Ø·ÙŠØ© Ø§Ù„Ø¯Ø³ÙˆÙ‚ÙŠ Ø¹Ø³ÙƒØ±	H8	G2	H4	G6	H5		H7	G8	H6		G3	G3	H4		G3		H7	G4	G5																			
ØµÙ„Ø§Ø­ Ø¹Ù„ÙˆÙŠ Ø­Ø³ÙŠÙ† Ø§Ù„Ø´Ø±ÙÙŠ	H8		H4				H7		H8								H7															C6						
Ù…Ø·Ø§Ø±Ø¯ Ø¯Ø®ÙŠÙ„ Ù†Ø§ØµØ± Ø§Ù„Ø¹Ù†Ø²ÙŠ			H5				H8																															
Ø§ÙŠØ§Ø¯ Ø§Ù„Ù†Ø§Ø¬ÙŠ			H5				H8															C7																
Ø§Ø­Ù…Ø¯ Ø¨Ø³ÙŠÙˆÙ†ÙŠ			H7																															C6				
Ø§Ø¯Ø§Ø±ÙŠ Ø§			H7																																			
Ù†Ù‡Ù‰ Ù…Ø±Ø¹ÙŠ 																																						
ÙˆÙØ§Ø¡ ÙØ§ÙŠØ²																									D8													
Ø±Ø¨Ø§Ø¨ ØµØ¨Ø±ÙŠ																																F9						
ÙˆØ§Ø¦Ù„ Ø§Ù„Ø¹Ù†Ø²ÙŠ																																				C8		`;

        function parseTabDelimitedData(text) {
            const lines = text.trim().split('\n');
            const headers = lines[0].split('\t');
            const result = [];
            
            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split('\t');
                const obj = {};
                for (let j = 0; j < headers.length; j++) {
                    obj[headers[j]] = values[j] || '';
                }
                result.push(obj);
            }
            return result;
        }

        function displayCurrentDate() {
            const today = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDate').textContent = today.toLocaleDateString('ar-SA', options);
        }

        function switchTab(tab) {
            const buttons = document.querySelectorAll('.tab-button');
            const contents = document.querySelectorAll('.tab-content');
            buttons.forEach(btn => btn.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));
            
            if (tab === 'monitor') {
                buttons[0].classList.add('active');
                document.getElementById('monitorTab').classList.add('active');
            } else if (tab === 'committee') {
                buttons[1].classList.add('active');
                document.getElementById('committeeTab').classList.add('active');
            } else if (tab === 'statistics') {
                buttons[2].classList.add('active');
                document.getElementById('statisticsTab').classList.add('active');
                loadStatistics();
            }
        }

        function transformData(rawData) {
            const transformed = [];
            rawData.forEach(monitorData => {
                const monitorName = monitorData['Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨'];
                Object.keys(monitorData).forEach(key => {
                    if (key !== 'Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨' && monitorData[key] && monitorData[key].trim() !== '') {
                        transformed.push({
                            monitor: monitorName,
                            period: key,
                            room: monitorData[key]
                        });
                    }
                });
            });
            return transformed;
        }

        function loadData() {
            try {
                const rawData = parseTabDelimitedData(RAW_DATA_TEXT);
                data = transformData(rawData);
                populateMonitors();
                populatePeriods();
                updateDashboardStats();
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
            }
        }

        function updateDashboardStats() {
            const monitors = new Set(data.map(item => item.monitor));
            const periods = new Set(data.map(item => item.period));
            const rooms = new Set(data.map(item => item.room));
            
            document.getElementById('totalMonitors').textContent = monitors.size;
            document.getElementById('totalPeriods').textContent = periods.size;
            document.getElementById('totalRooms').textContent = rooms.size;
            document.getElementById('totalAssignments').textContent = data.length;
        }

        function loadStatistics() {
            generateDetailedStats();
            generateTopMonitors();
            generateTopRooms();
        }

        function generateDetailedStats() {
            const monitors = new Set(data.map(item => item.monitor));
            const periods = new Set(data.map(item => item.period));
            const rooms = new Set(data.map(item => item.room));
            
            const morningPeriods = data.filter(item => item.period.includes('Ø§Ù„Ø£ÙˆÙ„Ù‰')).length;
            const eveningPeriods = data.filter(item => item.period.includes('Ø§Ù„Ø«Ø§Ù†ÙŠØ©')).length;
            const afternoonPeriods = data.filter(item => item.period.match(/\d+\(.*\)/)).length;
            
            const html = `
                <div class="stat-item">
                    <span>ğŸ“Œ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†</span>
                    <strong style="color: #2563eb;">${monitors.size} Ù…Ø±Ø§Ù‚Ø¨/Ø©</strong>
                </div>
                <div class="stat-item">
                    <span>ğŸŒ… ÙØªØ±Ø§Øª ØµØ¨Ø§Ø­ÙŠØ© (Ø§Ù„Ø£ÙˆÙ„Ù‰)</span>
                    <strong style="color: #10b981;">${morningPeriods} Ù…Ù‡Ù…Ø©</strong>
                </div>
                <div class="stat-item">
                    <span>ğŸŒ† ÙØªØ±Ø§Øª ØµØ¨Ø§Ø­ÙŠØ© (Ø§Ù„Ø«Ø§Ù†ÙŠØ©)</span>
                    <strong style="color: #f59e0b;">${eveningPeriods} Ù…Ù‡Ù…Ø©</strong>
                </div>
                <div class="stat-item">
                    <span>ğŸŒ™ ÙØªØ±Ø§Øª Ù…Ø³Ø§Ø¦ÙŠØ©</span>
                    <strong style="color: #8b5cf6;">${afternoonPeriods} Ù…Ù‡Ù…Ø©</strong>
                </div>
                <div class="stat-item">
                    <span>ğŸ« Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©</span>
                    <strong style="color: #ec4899;">${rooms.size} Ù‚Ø§Ø¹Ø©</strong>
                </div>
                <div class="stat-item">
                    <span>ğŸ“Š Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…Ù‡Ø§Ù… Ù„ÙƒÙ„ Ù…Ø±Ø§Ù‚Ø¨</span>
                    <strong style="color: #06b6d4;">${(data.length / monitors.size).toFixed(1)} Ù…Ù‡Ù…Ø©</strong>
                </div>
            `;
            document.getElementById('detailedStats').innerHTML = html;
        }

        function generateTopMonitors() {
            const monitorCounts = {};
            data.forEach(item => {
                monitorCounts[item.monitor] = (monitorCounts[item.monitor] || 0) + 1;
            });
            
            const sorted = Object.entries(monitorCounts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);
            
            const maxCount = sorted[0]?.[1] || 1;
            
            let html = '';
            sorted.forEach(([monitor, count], index) => {
                const percentage = (count / maxCount) * 100;
                const medal = index === 0 ? 'ğŸ¥‡' : index === 1 ? 'ğŸ¥ˆ' : index === 2 ? 'ğŸ¥‰' : `${index + 1}.`;
                html += `
                    <div style="margin-bottom: 1rem;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span>${medal} ${monitor}</span>
                            <strong style="color: #2563eb;">${count} Ù…Ù‡Ù…Ø©</strong>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${percentage}%">
                                ${percentage.toFixed(0)}%
                            </div>
                        </div>
                    </div>
                `;
            });
            document.getElementById('topMonitors').innerHTML = html;
        }

        function generateTopRooms() {
            const roomCounts = {};
            data.forEach(item => {
                roomCounts[item.room] = (roomCounts[item.room] || 0) + 1;
            });
            
            const sorted = Object.entries(roomCounts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 15);
            
            const maxCount = sorted[0]?.[1] || 1;
            
            let html = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">';
            sorted.forEach(([room, count]) => {
                const percentage = (count / maxCount) * 100;
                html += `
                    <div style="background: #0f172a; padding: 1rem; border-radius: 8px; border: 1px solid #334155;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                            <strong style="color: #2563eb; font-size: 1.2rem;">Ù‚Ø§Ø¹Ø© ${room}</strong>
                            <span style="color: #10b981;">${count}</span>
                        </div>
                        <div class="progress-bar" style="height: 8px;">
                            <div class="progress-fill" style="width: ${percentage}%; padding: 0;"></div>
                        </div>
                    </div>
                `;
            });
            html += '</div>';
            document.getElementById('topRooms').innerHTML = html;
        }

        function populateMonitors() {
            const monitors = [...new Set(data.map(item => item.monitor))].filter(m => m).sort();
            const monitorSelect = document.getElementById('monitorSelect');
            const committeeMonitorSelect = document.getElementById('committeeMonitorSelect');
            monitors.forEach(monitor => {
                const option1 = document.createElement('option');
                option1.value = monitor;
                option1.textContent = monitor;
                monitorSelect.appendChild(option1);
                const option2 = document.createElement('option');
                option2.value = monitor;
                option2.textContent = monitor;
                committeeMonitorSelect.appendChild(option2);
            });
        }

        function populatePeriods() {
            const periods = [...new Set(data.map(item => item.period))].filter(p => p).sort();
            const periodSelect = document.getElementById('periodSelect');
            periods.forEach(period => {
                const option = document.createElement('option');
                option.value = period;
                option.textContent = period;
                periodSelect.appendChild(option);
            });
        }

        function loadMonitorSchedule() {
            const selectedMonitor = document.getElementById('monitorSelect').value;
            const resultDiv = document.getElementById('monitorResult');
            if (!selectedMonitor) {
                resultDiv.innerHTML = '';
                return;
            }
            const schedule = data.filter(item => item.monitor === selectedMonitor);
            if (schedule.length === 0) {
                resultDiv.innerHTML = '<div class="card"><div class="no-data">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙØªØ±Ø§Øª Ù…Ø±Ø§Ù‚Ø¨Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨</div></div>';
                return;
            }
            let html = `<div class="card"><h2 style="color: #2563eb; margin-bottom: 1.5rem;">Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨: ${selectedMonitor}</h2><table><thead><tr><th>Ø§Ù„ÙØªØ±Ø©</th><th>Ø§Ù„Ù‚Ø§Ø¹Ø©</th></tr></thead><tbody>`;
            schedule.forEach(item => {
                html += `<tr><td>${item.period}</td><td>${item.room}</td></tr>`;
            });
            html += '</tbody></table></div>';
            resultDiv.innerHTML = html;
        }

        function searchCommittee() {
            const period = document.getElementById('periodSelect').value;
            const room = document.getElementById('roomInput').value.trim();
            const monitor = document.getElementById('committeeMonitorSelect').value;
            let results = data;
            if (period) results = results.filter(item => item.period === period);
            if (room) results = results.filter(item => item.room.toString().includes(room));
            if (monitor) results = results.filter(item => item.monitor === monitor);
            displayCommitteeResults(results);
        }

        function displayCommitteeResults(results) {
            const resultDiv = document.getElementById('committeeResult');
            if (results.length === 0) {
                resultDiv.innerHTML = '<div class="card"><div class="no-data">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„Ø¨Ø­Ø«</div></div>';
                return;
            }
            let html = `<div class="card"><h2 style="color: #2563eb; margin-bottom: 1.5rem;">Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« (${results.length} Ù†ØªÙŠØ¬Ø©)</h2><table><thead><tr><th>Ø§Ù„ÙØªØ±Ø©</th><th>Ø§Ù„Ù‚Ø§Ø¹Ø©</th><th>Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨</th></tr></thead><tbody>`;
            results.forEach(item => {
                html += `<tr><td>${item.period}</td><td>${item.room}</td><td>${item.monitor}</td></tr>`;
            });
            html += '</tbody></table></div>';
            resultDiv.innerHTML = html;
        }

        window.addEventListener('DOMContentLoaded', () => {
            displayCurrentDate();
            loadData();
        });
    </script>
</body>
</html>